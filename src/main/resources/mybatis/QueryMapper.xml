<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="QueryMapper">
	
    <!-- 用户登录 -->
    <resultMap id="mRetLoginMap" 					type="userModel">
		<result property="userId"  					column="userId"/>
		<result property="userName"  				column="userName"/>
		<result property="name"  					column="name"/>
		<result property="userSysId"  				column="userSysId"/>
		<result property="userPwd"  				column="userPass"/>
		<result property="gender"  					column="gender"/>
		<result property="birthdate"  				column="birthdate"/>
		<result property="cellphone"  				column="cellphone"/>
		<result property="email"  					column="email"/>
		
		<result property="credentialType"  			column="credentialType"/>
		<result property="credentialNo"  			column="credentialNo"/>
		<result property="isSoldier"  				column="isSoldier"/>
		<result property="isDisablity"  			column="isDisablity"/>
		<result property="height"  					column="height"/>
		
		<result property="weight"  					column="weight"/>
		<result property="nationality"  			column="nationality"/>
		<result property="nativePlace"  			column="nativePlace"/>
		<result property="marriageStatus"  			column="marriageStatus"/>
		<result property="householdType"  			column="householdType"/>
		
		<result property="education"  				column="education"/>
		<result property="policticsStatus"  		column="policticsStatus"/>
		<result property="homePhone"  				column="homePhone"/>
		<result property="homeAddress"  			column="homeAddress"/>
		<result property="photo"  					column="photo"/>
	</resultMap>
	
	<!-- 加载最新一条建议 -->
	<resultMap id="mRetAdviceOneMap" 		type="outModel">
		<result property="id"  				column="id"/>
		<result property="a"  				column="adviceTime"/>
		<result property="b"  				column="adviceContent"/>
	</resultMap>
	
	<!-- 查询建议执行记录总数 -->
	<resultMap id="mRetAdvicePerformaceMap" 		type="outModel">
		<result property="id"  						column="id"/>
		<result property="a"  						column="recordTime"/>
		<result property="b"  						column="doctorAdvicePerformace"/>
	</resultMap>
	
	<!-- 查询建议执行记录总数 -->
	<resultMap id="mRetServiceMap" 					type="serviceModel">
		<result property="id"  						column="id"/>
		<result property="type"  					column="serviceType"/>
		<result property="name"  					column="serviceName"/>
		<result property="content"  				column="serviceContent"/>
		<result property="creatorId"  				column="serviceCreatorId"/>
		<result property="createTime"  				column="serviceCreateTime"/>
		<result property="sdate"  					column="serviceStartDate"/>
		<result property="edate"  					column="serviceDuration"/>
		<result property="memo"  					column="serviceMemo"/>
		<result property="icon"  					column="serviceIcon"/>
		<result property="userId"  					column="userId"/>
	</resultMap>
	
	<!-- 加载设备 -->
	<resultMap id="mRetDeviceMap" 					type="deviceModel">
		<result property="id"  						column="deviceId"/>
		<result property="type"  					column="deviceType"/>
		<result property="typeName"  				column="name"/>
		<result property="model"  					column="deviceModel"/>
		<result property="no"  						column="deviceNo"/>
		<result property="sim"  					column="deviceSim"/>
		<result property="buyTime"  				column="buyTime"/>
		<result property="userId"  					column="userId"/>
	</resultMap>		
		
	<!-- 查询亲情号码 -->
	<resultMap id="mRelativePhoneMap" 				type="relativePhoneModel">
		<result property="id"  						column="id"/>
		<result property="userId"  					column="userId"/>
		<result property="type"  					column="relativeType"/>
		<result property="name"  					column="relativeName"/>
		<result property="cellPhone"  				column="relativeCellPhone"/>
		<result property="tel"  					column="relativeTel"/>
		<result property="address"  				column="relativeAddr"/>
	</resultMap>
	
	<!-- 加载用户基本信息 -->
	<resultMap id="mRetUserBaseMap" 				type="userModel">
		<result property="userId"  					column="userId"/>
		<result property="name"  					column="name"/>
		<result property="gender"  					column="gender"/>
		<result property="birthdate"  				column="birthdate"/>
		<result property="cellphone"  				column="cellphone"/>
		<result property="email"  					column="email"/>
		
		<result property="credentialType"  			column="credentialType"/>
		<result property="credentialNo"  			column="credentialNo"/>
		<result property="isSoldier"  				column="isSoldier"/>
		<result property="isDisablity"  			column="isDisablity"/>
		<result property="height"  					column="height"/>
		
		<result property="weight"  					column="weight"/>
		<result property="nationality"  			column="nationality"/>
		<result property="nativePlace"  			column="nativePlace"/>
		<result property="marriageStatus"  			column="marriageStatus"/>
		<result property="householdType"  			column="householdType"/>
		
		<result property="education"  				column="education"/>
		<result property="policticsStatus"  		column="policticsStatus"/>
		<result property="homePhone"  				column="homePhone"/>
		<result property="homeAddress"  			column="homeAddress"/>
		<result property="workingAge"  				column="workingAge"/>
		
		<result property="salary"  					column="salary"/>
		<result property="companyName"  			column="companyName"/>
		<result property="companyAddress"  			column="companyAddress"/>
		<result property="photo"  					column="photo"/>
	</resultMap>
	
	
	
	<!-- 查询生活习惯 -->
	<resultMap id="mRetHabbitMap" 					type="habbitModel">
		<result property="id"  						column="id"/>
		<result property="userId"  					column="userId"/>
		<result property="workType"  				column="workType"/>
		<result property="workPressure"  			column="workPressure"/>
		<result property="bloodType"  				column="bloodType"/>
		<result property="weight"  					column="weight"/>
		<result property="waist"  					column="waist"/>
		<result property="smokeType"  				column="smokeType"/>
		<result property="smokeFrequency"  			column="smokeFrequency"/>
		<result property="drinkFrequency"  			column="drinkFrequency"/>
		<result property="drinkType"  				column="drinkType"/>
		<result property="exerciseFrequency"  		column="exerciseFrequency"/>
		<result property="exerciseDuration"  		column="exerciseDuration"/>
		<result property="sleepDuration"  			column="sleepDuration"/>
	</resultMap>
	
	<!-- 查询家族遗传史 -->
	<resultMap id="mRetGeneticDiseaseMap" 			type="geneticDiseaseModel">
		<result property="id"  						column="id"/>
		<result property="userId"  					column="userId"/>
		<result property="isHeartDisease"  			column="isHeartDisease"/>
		<result property="isHypertension"  			column="isHypertension"/>
		<result property="isHyperlipemia"  			column="isHyperlipemia"/>
		<result property="isDiabetesMellitus"  		column="isDiabetesMellitus"/>
		<result property="isCoronaryDisease"  		column="isCoronaryDisease"/>
	</resultMap>
	
	<!-- 查询疾病史 -->
	<resultMap id="mRetDiseaseHisMap" 				type="diseaseHisModel">
		<result property="id"  						column="id"/>
		<result property="userId"  					column="userId"/>
		<result property="diseaseName"  			column="diseaseName"/>
		<result property="startDate"  				column="startDate"/>
		<result property="endDate"  				column="endDate"/>
		<result property="descInHospital"  			column="descInHospital"/>
		<result property="descObserve"  			column="descObserve"/>
		<result property="memo"  					column="memo"/>
	</resultMap>
	
	<!-- 询医护人员列表 -->
	<resultMap id="mRetNurseMap" 					type="userModel">
		<result property="userId"  					column="userId"/>
		<result property="name"  					column="name"/>
		<result property="cellphone"  				column="cellphone"/>
		<result property="gender"  					column="gender"/>
		<result property="score"  					column="score"/>
		<result property="cnt"  					column="cnt"/>
	</resultMap>
	
	
	<!-- 询医护人员列表 -->
	<resultMap id="mRetMyNurseMap" 					type="userModel">
		<result property="userId"  					column="userId"/>
		<result property="name"  					column="name"/>
		<result property="gender"  					column="gender"/>
		<result property="birthdate"  				column="birthdate"/>
		<result property="cellphone"  				column="cellphone"/>
		<result property="email"  					column="email"/>
		
		<result property="credentialType"  			column="credentialType"/>
		<result property="credentialNo"  			column="credentialNo"/>
		<result property="isSoldier"  				column="isSoldier"/>
		<result property="isDisablity"  			column="isDisablity"/>
		<result property="height"  					column="height"/>
		
		<result property="weight"  					column="weight"/>
		<result property="nationality"  			column="nationality"/>
		<result property="nativePlace"  			column="nativePlace"/>
		<result property="marriageStatus"  			column="marriageStatus"/>
		<result property="householdType"  			column="householdType"/>
		
		<result property="education"  				column="education"/>
		<result property="policticsStatus"  		column="policticsStatus"/>
		<result property="homePhone"  				column="homePhone"/>
		<result property="homeAddress"  			column="homeAddress"/>
		<result property="photo"  					column="photo"/>
		<result property="score"  					column="score"/>
		<result property="cnt"  					column="cnt"/>
		<result property="achievement"  			column="achievement"/>
	</resultMap>
	
	
	<!-- 询医护人员列表 -->
	<resultMap id="mRetNurseRequestMap" 			type="nurseRequestModel">
	    <result property="id"  						column="id"/>
	    <result property="userId"  					column="userId"/>
		<result property="nurseId"  				column="nurseId"/>
		<result property="nurseName"  				column="name"/>
		<result property="status"  					column="status"/>
		<result property="requestTime"  			column="requestTime"/>
		<result property="responseTime"  			column="responseTime"/>
		<result property="memo"  					column="memo"/>
	</resultMap>
	
	
	<!-- 查询消息列表数据 -->
	<resultMap id="mRetMessageMap" 					type="messageModel">
	    <result property="id"  						column="id"/>
	    <result property="senderId"  				column="senderId"/>
		<result property="receiverId"  				column="receiverId"/>
		<result property="sendTime"  				column="sendTime"/>
		<result property="status"  					column="status"/>
		<result property="readTime"  				column="readTime"/>
		<result property="msg"  					column="msg"/>
		<result property="name"  					column="name"/>
	</resultMap>
	
	<!-- 分页查询活动记录 -->
    <resultMap id="mRetActivityMap" 				type="activityModel">
		<result property="id"  						column="activityId"/>
		<result property="type"  					column="activityType"/>
		<result property="name"  					column="activityName"/>
		<result property="content"  				column="activityContent"/>
		<result property="creatorId"  				column="activityCreatorId"/>
		<result property="createTime"  				column="activityCreateTime"/>
		<result property="sdate"  					column="activityStartDate"/>
		<result property="edate"  					column="activityDuration"/>
		<result property="memo"  					column="activityMemo"/>
		<result property="icon"  					column="activityIcon"/>
	</resultMap>
	
    <!-- 活动医生 -->
    <resultMap id="mDoctorMap" 		      type="doctorModel">
		<result property="doctorId"       column="doctorId"/>
		<result property="doctorName"  	  column="doctorName"/>
	</resultMap>
	
	
    <!-- 加载论坛 -->
    <resultMap id="mRetPostMap" 		      	type="postModel">
		<result property="id"       			column="postId"/>
		<result property="title"  	  			column="postTitle"/>
		<result property="content"  	  		column="postContent"/>
		<result property="stime"  	  			column="postTime"/>
		<result property="userId"  	  			column="postUserId"/>
		<result property="userName"  	 	 	column="postUserName"/>
		<result property="photo"  	 	 		column="photo"/>
	</resultMap>
    
    <!-- 加载论坛 -->
    <resultMap id="mRetPostCommentMap" 		     type="commentModel">
		<result property="content"  	  		column="commentContent"/>
		<result property="stime"  	  			column="commentTime"/>
		<result property="userName"  	 	 	column="commentUserName"/>
		<result property="photo"  	 	 		column="photo"/>
	</resultMap>
    
	
    <!-- 统计 -->
    <resultMap id="mRetStatBooldMap" 		    type="bloodModel">
		<result property="value"  	  			column="value"/>
		<result property="type"  	  			column="flag"/>
		<result property="stime"  	 	 		column="takeTime"/>
	</resultMap>
    
    <!-- 统计血压 -->
    <resultMap id="mRetStatBooldPressureMap" 	type="outModel">
        <result property="a"  	  				column="takeTime"/>
		<result property="a1"  	  				column="highBloodPressure"/>
		<result property="a2"  	  				column="lowBloodPressure"/>
		<result property="a3"  	 	 			column="pulse"/>
	</resultMap>
	
    <!-- 加载近期血糖 -->
    <resultMap id="mRetRecentlyHomeBloodMap" 	type="outModel">
		<result property="a"  	  				column="takeTime1"/>
		<result property="b"  	  				column="bloodGlucose1"/>
		<result property="c"  	 	 			column="takeTime2"/>
		<result property="d"  	 	 			column="bloodGlucose2"/>
	</resultMap>
    
    	
    
    <!-- 加载近期体温 -->
    <resultMap id="mRetRecentlyHomeEarMap" 		type="outModel">
		<result property="e"  	  				column="takeTime"/>
		<result property="f"  	  				column="temperature"/>
	</resultMap>
	
    
    
    <!-- 加载近期血压-->
    <resultMap id="mRetRecentlyHomePressureMap" type="outModel">
		<result property="g"  	  				column="takeTime"/>
		<result property="h"  	  				column="BloodPressure"/>
	</resultMap>
    
    <!-- 首页加载医嘱  -->
    <resultMap id="mRetHomeDoctorAdviceMap" 	type="outModel">
		<result property="a"  	  				column="a"/>
		<result property="b"  	  				column="b"/>
		<result property="c"  	  				column="c"/>
		<result property="d"  	  				column="d"/>
	</resultMap>
	
    
    <!-- 加载用户信息 -->
	<resultMap id="mRetHealthUserMap" 				type="userModel">
		<result property="userId"  					column="userId"/>
		<result property="name"  					column="name"/>
		<result property="gender"  					column="gender"/>
		<result property="birthdate"  				column="birthdate"/>
		<result property="height"  					column="height"/>
		<result property="weight"  					column="weight"/>
		<result property="bmi"  					column="bmi"/>
	</resultMap>
	
	<!-- 加载运动记录 -->
	<resultMap id="mRetHealthSportMap" 				type="outModel">
		<result property="a"  						column="sportName"/>
		<result property="b"  						column="sportTime"/>
		<result property="c"  						column="sportDuration"/>
		<result property="d"  						column="caloriePerMinute"/>
	</resultMap>
    
	<resultMap id="mRetHealthSportMonthFxMap" 		type="outModel">
		<result property="a"  						column="a"/>
		<result property="b"  						column="b"/>
		<result property="c"  						column="c"/>
		<result property="d"  						column="d"/>
	</resultMap>
	
	
	<!-- 加载饮食记录 -->
	<resultMap id="mRetHealthFootMap" 				type="outModel">
		<result property="a"  						column="mealFlag"/>
		<result property="b"  						column="mealTime"/>
		<result property="c"  						column="amount"/>
	</resultMap>
	
	
	<!-- 加载饮食记录 -->
	<resultMap id="mRetHealthFootMonthMap" 			type="outModel">
		<result property="a"  						column="name"/>
		<result property="b"  						column="amount"/>
		<result property="c"  						column="caloriePerHundredGram"/>
		<result property="d"  						column="avgAmount"/>
		<result property="e"  						column="avgCaloriePerHundredGram"/>
	</resultMap>
	
	
	<!-- 加载饮食记录 -->
	<resultMap id="mRetHealthFootItemMap" 			type="outModel">
		<result property="a1"  						column="id"/>
		<result property="a"  						column="name"/>
		<result property="b"  						column="amount"/>
	</resultMap>
	
	
	<!-- 加载饮食记录 -->
	<resultMap id="mRetHealthMentalMap" 				type="outModel">
		<result property="a"  							column="mentalStatus"/>
		<result property="b"  							column="recordTime"/>
	</resultMap>
	
	
	<!-- 加载饮食记录 -->
	<resultMap id="mRetHealthMentalMonthMap" 			type="outModel">
		<result property="a1"  							column="mentalStatus"/>
		<result property="a2"  							column="cnt"/>
	</resultMap>
	
	
	
	<!-- 加载血压 -->
	<resultMap id="mRetHealthPressureMap" 				type="outModel">
		<result property="a"  							column="takeTime"/>
		<result property="b"  							column="highBloodPressure"/>
		<result property="c"  							column="lowBloodPressure"/>
		<result property="d"  							column="pulse"/>
	</resultMap>
	
	<!-- 加载血压 按月-->
	<resultMap id="mRetHealthPressureMonthMap" 			type="outModel">
		<result property="a1"  							column="a1"/>
		<result property="a2"  							column="a2"/>
		<result property="a3"  							column="a3"/>
		<result property="a4"  							column="a4"/>
		<result property="a5"  							column="a5"/>
		<result property="a6"  							column="a6"/>
	</resultMap>
	
	
	
	<!-- 加载血压 -->
	<resultMap id="mRetHealthPulseMap" 					type="outModel">
		<result property="a"  							column="takeTime"/>
		<result property="b"  							column="heartRate"/>
	</resultMap>
	
	
	<!-- 加载血压 按月-->
	<resultMap id="mRetHealthPulseMonthMap" 			type="outModel">
		<result property="a1"  							column="a1"/>
		<result property="a2"  							column="a2"/>
		<result property="a3"  							column="a3"/>
		<result property="a4"  							column="a4"/>
	</resultMap>
	
	
	<!-- 加载血糖 -->
	<resultMap id="mRetHealthGlucoseMap" 				type="outModel">
		<result property="a"  							column="takeTime1"/>
		<result property="b"  							column="bloodGlucose1"/>
		<result property="c"  							column="takeTime2"/>
		<result property="d"  							column="bloodGlucose2"/>
	</resultMap>
	
	<!-- 加载血糖 按月-->
	<resultMap id="mRetHealthGlucoseMonthMap" 			type="outModel">
		<result property="a1"  							column="a1"/>
		<result property="a2"  							column="a2"/>
		<result property="a3"  							column="a3"/>
	</resultMap>
	
	
	<!-- 加载体温 -->
	<resultMap id="mRetHealthThermometerMap" 				type="outModel">
		<result property="a"  								column="takeTime"/>
		<result property="b"  								column="temperature"/>
	</resultMap>
	
	
	<!-- 用药记录 -->
	<resultMap id="mRetHealthMedicineMap" 					type="outModel">
		<result property="a"  								column="medicineName"/>
		<result property="b"  								column="medicineTime"/>
		<result property="c"  								column="medicineAmount"/>
		<result property="d"  								column="medicineUnit"/>
	</resultMap>
	
	
	<!-- 用药记录 按月-->
	<resultMap id="mRetHealthMedicineMonthMap" 				type="outModel">
		<result property="a"  								column="a"/>
		<result property="b"  								column="b"/>
		<result property="c"  								column="c"/>
		<result property="d"  								column="d"/>
		<result property="e"  								column="e"/>
	</resultMap>
	
	
	<!-- 用药记录 管理-->
	<resultMap id="mRetMedicineMap" 						type="medicineModel">
		<result property="id"  								column="id"/>
		<result property="userId"  							column="userId"/>
		<result property="medicineName" 					column="medicineName"/>
		<result property="medicineAmount"  					column="medicineAmount"/>
		<result property="medicineUnit"  					column="medicineUnit"/>
		<result property="medicineTime"  					column="medicineTime"/>
	</resultMap>
	
	
	<resultMap id="mRetHealthReportMap" 					type="healthReportModel">
		<result property="id"  								column="id"/>
		<result property="reportFlag"  						column="reportFlag"/>
		<result property="sportLevel"  						column="sportLevel"/>
		<result property="sportAdvice"  					column="sportAdvice"/>
		<result property="dietLevel"  						column="dietLevel"/>
		<result property="dietAdvice"  						column="dietAdvice"/>
		<result property="mentalAdvice"  					column="mentalAdvice"/>
		<result property="bloodPressureAdvice"  			column="bloodPressureAdvice"/>
		<result property="bloodGlucoseAdvice"  				column="bloodGlucoseAdvice"/>
		<result property="heartRateAdvice"  				column="heartRateAdvice"/>
		<result property="temperatureAdvice"  				column="temperatureAdvice"/>
		<result property="medicationAdvice"  				column="medicationAdvice"/>
		<result property="reportTime"  						column="reportTime"/>
		<result property="accessment"  						column="Accessment"/>
		<result property="recordTime"  						column="recordTime"/>
	</resultMap>
	
	
	<!-- 用户登录 -->
	<select id="QueryMapper.queryLoginInfo" 	parameterType="userModel"	resultMap="mRetLoginMap">
		<![CDATA[
			select a1.*
			from tab_user a1 
			where a1.userSysId = 1
			and a1.userName = #{userName}
		]]>
	</select>
	
	
	<!-- 加载最新一条建议 -->
	<select id="QueryMapper.queryAdviceInfo" 	parameterType="queryModel"	resultMap="mRetAdviceOneMap">
		<![CDATA[
			select a.id, a.adviceTime, a.adviceContent 
			from tab_doctor_advice a 
			where a.adviceTypId = #{adviceType}
			and a.userId = #{userId}
			limit 0, 1
		]]>
	</select>
	
	<!-- 查询建议执行记录总数 -->
	<select id="QueryMapper.queryAdvicePerformaceCnt" 	parameterType="queryModel"	resultType="long">
		<![CDATA[
			select count(1) as cnt 
			from tab_doctor_advice_performace a 
			where a.doctorAdviceId = #{id}
		]]>
	</select>
	
	
	<!-- 查询建议执行记录 -->
	<select id="QueryMapper.queryAdvicePerformace" 	parameterType="queryModel"	resultMap="mRetAdvicePerformaceMap">
		<![CDATA[
			select a.id, a.recordTime, a.doctorAdvicePerformace 
			from tab_doctor_advice_performace a 
			where a.doctorAdviceId = #{id}
			order by a.recordTime desc
			limit #{startNum}, #{rows}
		]]>
	</select>
	
	<!-- 查询我的服务总数 -->
	<select id="QueryMapper.queryServiceInfoCnt" 	parameterType="queryModel"	resultType="long">
		<![CDATA[
			select count(1) as cnt  
			from tab_service a1
			left join tab_user_service a2 on a1.id=a2.serviceId and a2.userId=#{userId}
		]]>
		<where>	
	        <if test="name != null and name != ''">
				AND a1.serviceName LIKE CONCAT('%', #{name}, '%') 
	        </if>
	        <if test="type != null and type != 3">
	            <![CDATA[
				AND a1.serviceType  < 3
				]]>
	        </if>
	        <if test="type != null and type == 3">
				AND a1.serviceType  = #{type}
	        </if>
		</where>
	</select>
	
	<!-- 分页加载我的服务数据 -->
	<select id="QueryMapper.queryServiceInfo" 	parameterType="queryModel"	resultMap="mRetServiceMap">
		<![CDATA[
			select a1.id, a1.serviceType, a1.serviceName, a1.serviceContent, a1.serviceCreatorId, 
				a1.serviceCreateTime, a1.serviceStartDate, a1.serviceDuration, 
				a1.serviceMemo, a1.serviceIcon, IFNULL(a2.userId,0) as userId 
			from tab_service a1
			left join tab_user_service a2 on a1.id=a2.serviceId and a2.userId=#{userId}
		]]>
		<where>	
	        <if test="name != null and name != ''">
				AND a1.serviceName LIKE CONCAT('%', #{name}, '%') 
	        </if>
	        <if test="type != null and type != 3">
				<![CDATA[
				AND a1.serviceType  < 3
				]]>
	        </if>
	        <if test="type != null and type == 3">
				AND a1.serviceType  = #{type}
	        </if>
		</where>
		<![CDATA[
			order by a1.serviceCreateTime desc
			limit #{startNum}, #{rows}
		]]>
	</select>
	
	
	<!-- 查询我的设备总数 -->
	<select id="QueryMapper.queryDeviceInfoCnt" 	parameterType="queryModel"	resultType="long">
		<![CDATA[
			select count(1) as cnt  
			from tab_device a1
			inner join tab_dict_device_type a2 on a1.deviceType=a2.id
			left join tab_user_device a3 on a3.deviceId=a1.deviceId and a3.userId=#{userId}
		]]>
		<where>	
	        <if test="deviceType != null and deviceType > 0">
				AND a1.deviceType  = #{deviceType}
	        </if>
	        <if test="type != null and type == 0">
				AND IFNULL(a3.userId, 0)  = #{type}
	        </if>
	        <if test="type != null and type > 0">
				AND IFNULL(a3.userId, 0)  = 1
	        </if>
		</where>
	</select>
	
	<!-- 分页加载我的设备数据 -->
	<select id="QueryMapper.queryDeviceInfo" 	parameterType="queryModel"	resultMap="mRetDeviceMap">
		<![CDATA[
			select a1.deviceId, a1.deviceType, a1.deviceModel, a1.deviceNo, a1.deviceSim, a2.name, IFNULL(a3.userId, 0) as userId, IFNULL(a3.buyTime, '-') as buyTime
			from tab_device a1
			inner join tab_dict_device_type a2 on a1.deviceType=a2.id
			left join tab_user_device a3 on a3.deviceId=a1.deviceId and a3.userId=#{userId}
		]]>
		<where>	
	        <if test="deviceType != null and deviceType > 0">
				AND a1.deviceType  = #{deviceType}
	        </if>
	        <if test="type != null and type == 0">
				AND IFNULL(a3.userId, 0)  = #{type}
	        </if>
	        <if test="type != null and type > 0">
				AND IFNULL(a3.userId, 0)  = 1
	        </if>
		</where>
		<![CDATA[
			order by a1.deviceModel
			limit #{startNum}, #{rows}
		]]>
	</select>
	
	<!-- 购买服务 -->
	<insert id="QueryMapper.modifyBuyServiceInfo" useGeneratedKeys="true" keyProperty="buyId">
	    <![CDATA[
	        INSERT INTO tab_user_service (userId, serviceId, buyTime) 
	        VALUES (#{userId}, #{id}, #{buyTime})
	    ]]>
	</insert>
	
	<!-- 购买服务 -->
	<insert id="QueryMapper.modifyBuyDeviceInfo" useGeneratedKeys="true" keyProperty="buyId">
	    <![CDATA[
	        INSERT INTO tab_user_device (userId, deviceId, buyTime) 
	        VALUES (#{userId}, #{id}, #{buyTime})
	    ]]>
	</insert>
	
	<!-- 修改密码 -->
	<update id="QueryMapper.modifyUserPwdInfo" parameterType="userModel">
		<![CDATA[
			UPDATE tab_user  SET  
			userPass = #{userNewPwd}
			WHERE userId = #{userId}
			and userPass = #{userPwd}
		]]>
	</update>
	
	
	<!-- 查询我的亲情号码总数 -->
	<select id="QueryMapper.queryRelativePhoneInfoCnt" 	parameterType="queryModel"	resultType="long">
		<![CDATA[
			select count(1) as cnt  
			from tab_relative_phone a1 
			where a1.userId=#{userId}
		]]>
	</select>
	
	<!-- 分页加载我的亲情号码数据 -->
	<select id="QueryMapper.queryRelativePhoneInfo" 	parameterType="queryModel"	resultMap="mRelativePhoneMap">
		<![CDATA[
			select a1.id, a1.relativeName, a1.relativeTel, a1.relativeType, a1.relativeCellPhone, a1.relativeAddr, a1.userId
			from tab_relative_phone a1
			where a1.userId=#{userId}
			order by a1.relativeName
			limit #{startNum}, #{rows}
		]]>
	</select>
	
	
	<!-- 分页加载我的亲情号码数据 -->
	<select id="QueryMapper.queryRelativePhoneInfoById" 	parameterType="queryModel"	resultMap="mRelativePhoneMap">
		<![CDATA[
			select a1.id, a1.relativeName, a1.relativeTel, a1.relativeType, a1.relativeCellPhone, a1.relativeAddr, a1.userId
			from tab_relative_phone a1
			where a1.id=#{id}
		]]>
	</select>
	
	
	<!-- 增加亲情号码 -->
	<insert id="QueryMapper.addRelativePhoneInfo" useGeneratedKeys="true" keyProperty="id">
	    <![CDATA[
	        INSERT INTO tab_relative_phone (userId, relativeName, relativeType, relativeCellPhone, relativeTel, relativeAddr) 
	        VALUES (#{userId}, #{name}, #{type}, #{cellPhone}, #{tel}, #{address})
	    ]]>
	</insert>
	
	
	<!-- 修改亲情号码 -->
	<update id="QueryMapper.modifyRelativePhoneInfo" parameterType="relativePhoneModel">
		<![CDATA[
			UPDATE tab_relative_phone  SET  
			relativeName = #{name},
			relativeType = #{type},
			relativeCellPhone = #{cellPhone},
			relativeTel = #{tel},
			relativeAddr = #{address}
			WHERE id = #{id}
		]]>
	</update>
	
	<!-- 删除亲情号码-->
	<delete id="QueryMapper.delRelativePhoneInfo" parameterType="relativePhoneModel">
		<![CDATA[
			DELETE FROM tab_relative_phone 
			WHERE id = #{id} 
		]]>
	</delete>
	
	<!-- 加载用户基本信息 -->
	<select id="QueryMapper.queryUserBaseInfo" 	parameterType="queryModel"	resultMap="mRetUserBaseMap">
		<![CDATA[
			select a1.*
			from tab_user a1
			where a1.userId=#{userId}
		]]>
	</select>
	
	<!-- 增加用户基本信息 -->
	<insert id="QueryMapper.addUserBaseInfo"  parameterType="userModel">
	    <![CDATA[
	        INSERT INTO tab_user (userId, name, gender, birthdate, cellphone, email, 
	        	credentialType, credentialNo, isSoldier, isDisablity, height, weight, 
	        	nationality, nativePlace, marriageStatus, householdType, education, 
	        	policticsStatus, homePhone, homeAddress, workingAge, salary, companyName, 
	        	companyAddress, photo) 
	        VALUES (#{userId}, #{name}, #{gender}, #{birthdate}, #{cellphone}, #{email}, 
	        	#{credentialType}, #{credentialNo}, #{isSoldier}, #{isDisablity}, #{height}, #{weight}, 
	        	#{nationality}, #{nativePlace}, #{marriageStatus}, #{householdType}, #{education}, 
	        	#{policticsStatus}, #{homePhone}, #{homeAddress}, #{workingAge}, #{salary}, #{companyName}, 
	        	#{companyAddress}, #{photo})
	    ]]>
	</insert>
	
	
	<!-- 删除用户基本信息-->
	<delete id="QueryMapper.delUserBaseInfo" parameterType="userModel">
		<![CDATA[
			DELETE FROM tab_user 
			WHERE userId = #{userId} 
		]]>
	</delete>
	
	<!-- 修改用户基础信息 -->
	<update id="QueryMapper.modifyUserBaseInfo" parameterType="userModel">
		<![CDATA[
			UPDATE tab_user  SET  
			name = #{name},
			gender = #{gender},
			birthdate = #{birthdate},
			cellphone = #{cellphone},
			email = #{email},
			photo=#{photo}
			WHERE userId = #{userId}
		]]>
	</update>
	
	
	<!-- 修改用户照片信息 -->
	<update id="QueryMapper.modifyUserPhotoInfo" parameterType="userModel">
		<![CDATA[
			UPDATE tab_user  SET  
			photo=#{photo}
			WHERE userId = #{userId}
		]]>
	</update>
	
	
	<!-- 修改用户详细信息 -->
	<update id="QueryMapper.modifyUserDetailInfo" parameterType="userModel">
		<![CDATA[
			UPDATE tab_user  SET  
			credentialType = #{credentialType},
			credentialNo = #{credentialNo},
			isSoldier = #{isSoldier},
			isDisablity = #{isDisablity},
			height = #{height},
			weight=#{weight},
			nationality=#{nationality},
			nativePlace=#{nativePlace},
			marriageStatus=#{marriageStatus},
			householdType=#{householdType},
			education=#{education},
			policticsStatus=#{policticsStatus},
			homeAddress=#{homeAddress},
			spouseName=#{spouseName},
			spousePhone=#{spousePhone},
			homePhone=#{homePhone}
			WHERE userId = #{userId}
		]]>
	</update>


	<!-- 修改用户工作信息 -->
	<update id="QueryMapper.modifyUserWorkInfo" parameterType="userModel">
		<![CDATA[
			UPDATE tab_user  SET  
			workingAge = #{workingAge},
			salary = #{salary},
			companyName = #{companyName},
			achievement = #{achievement},
			companyAddress = #{companyAddress}
			WHERE userId = #{userId}
		]]>
	</update>
	
	
	<!-- 加载生活习惯数据 -->
	<select id="QueryMapper.queryHabbitInfo" 	parameterType="queryModel"	resultMap="mRetHabbitMap">
		<![CDATA[
			select a1.*
			from tab_habbit a1
			where a1.userId=#{userId}
		]]>
	</select>
	
	<!-- 增加生活习惯 -->
	<insert id="QueryMapper.addHabbitInfo"  parameterType="habbitModel"  useGeneratedKeys="true" keyProperty="id">
	    <![CDATA[
	        INSERT INTO tab_habbit (userId) 
	        VALUES (#{userId})
	    ]]>
	</insert>
	
	<!-- 修改生活习惯 -->
	<update id="QueryMapper.modifyHabbitInfo" parameterType="habbitModel">
		<![CDATA[
			UPDATE tab_habbit  SET  
			workType = #{workType},
			workPressure = #{workPressure},
			bloodType = #{bloodType},
			weight = #{weight},
			waist = #{waist},
			smokeType = #{smokeType},
			smokeFrequency = #{smokeFrequency},
			drinkFrequency = #{drinkFrequency},
			drinkType = #{drinkType},
			exerciseFrequency = #{exerciseFrequency},
			exerciseDuration = #{exerciseDuration},
			sleepDuration = #{sleepDuration}
			WHERE userId = #{userId}
		]]>
	</update>
		
	
	<!-- 加载家族遗传史 -->
	<select id="QueryMapper.queryGeneticDiseaseInfo" 	parameterType="queryModel"	resultMap="mRetGeneticDiseaseMap">
		<![CDATA[
			select a1.*
			from tab_genetic_disease a1
			where a1.userId=#{userId}
		]]>
	</select>	
	
	
	<!-- 增加家族遗传史 -->
	<insert id="QueryMapper.addGeneticDiseaseInfo"  parameterType="geneticDiseaseModel"  useGeneratedKeys="true" keyProperty="id">
	    <![CDATA[
	        INSERT INTO tab_genetic_disease (userId) 
	        VALUES (#{userId})
	    ]]>
	</insert>
	
	
	<!-- 修改家族遗传史 -->
	<update id="QueryMapper.modifyGeneticDiseaseInfo" parameterType="geneticDiseaseModel">
		<![CDATA[
			UPDATE tab_genetic_disease  SET  
			isHeartDisease = #{isHeartDisease},
			isHypertension = #{isHypertension},
			isHyperlipemia = #{isHyperlipemia},
			isDiabetesMellitus = #{isDiabetesMellitus},
			isCoronaryDisease = #{isCoronaryDisease}
			WHERE userId = #{userId}
		]]>
	</update>
	
	
	<!-- 查询疾病史总记录数 -->
	<select id="QueryMapper.queryDiseaseHisInfoCnt" 	parameterType="queryModel"	resultType="long">
		<![CDATA[
			select count(1) as cnt  
			from tab_disease_history a1 
			where a1.userId=#{userId}
		]]>
	</select>
	
	<!-- 分页加载疾病史记录 -->
	<select id="QueryMapper.queryDiseaseHisInfo" 	parameterType="queryModel"	resultMap="mRetDiseaseHisMap">
		<![CDATA[
			select a1.descInHospital, a1.descObserve, a1.diseaseName, a1.endDate, a1.id, a1.memo, a1.startDate, a1.userId
			from tab_disease_history a1
			where a1.userId=#{userId}
			order by a1.startDate desc
			limit #{startNum}, #{rows}
		]]>
	</select>
	
	<!-- 分页加载疾病史记录根据ID -->
	<select id="QueryMapper.queryDiseaseHisInfoById" 	parameterType="queryModel"	resultMap="mRetDiseaseHisMap">
		<![CDATA[
			select a1.descInHospital, a1.descObserve, a1.diseaseName, a1.endDate, a1.id, a1.memo, a1.startDate, a1.userId
			from tab_disease_history a1
			where a1.id=#{id}
		]]>
	</select>
	
	
	<!-- 增加疾病史记录 -->
	<insert id="QueryMapper.addDiseaseHisInfo"  parameterType="diseaseHisModel"  useGeneratedKeys="true" keyProperty="id">
	    <![CDATA[
	        INSERT INTO tab_disease_history (userId, startDate, endDate, diseaseName, descInHospital, descObserve, memo) 
	        VALUES (#{userId}, #{startDate}, #{endDate}, #{diseaseName}, #{descInHospital}, #{descObserve}, #{memo})
	    ]]>
	</insert>
	
	<!-- 修改疾病史记录 -->
	<update id="QueryMapper.modifyDiseaseHisInfo" parameterType="diseaseHisModel">
		<![CDATA[
			UPDATE tab_disease_history  SET  
			startDate = #{startDate},
			endDate = #{endDate},
			diseaseName = #{diseaseName},
			descInHospital = #{descInHospital},
			descObserve = #{descObserve},
			memo = #{memo}
			WHERE id = #{id}
		]]>
	</update>
	
	<!-- 删除疾病史记录-->
	<delete id="QueryMapper.delDiseaseHisInfo" parameterType="relativePhoneModel">
		<![CDATA[
			DELETE FROM tab_disease_history 
			WHERE id = #{id} 
		]]>
	</delete>
	
	
	<!-- 查询医护人员列表总数 -->
	<select id="QueryMapper.queryNurseInfoCnt" 	parameterType="queryModel"	resultType="long">
		<![CDATA[
			select count(1) as cnt  
			from tab_user a1
			inner join tab_user a2 on a1.userId=a2.userId and a1.userSysId=2
		]]>
		<where>	
	        <if test="name != null and name != ''">
				AND a2.name LIKE CONCAT('%', #{name}, '%') 
	        </if>
		</where>
	</select>
	
	
	<!-- 分页查询医护人员列表 -->
	<select id="QueryMapper.queryNurseInfo" 	parameterType="queryModel"	resultMap="mRetNurseMap">
		<![CDATA[
			select a1.userId, a2.name, a2.cellphone, a2.gender, IFNULL(a3.score, 0) as score, IFNULL(a4.cnt,0) as cnt
			from tab_user a1
			inner join tab_user a2 on a1.userId=a2.userId and a1.userSysId=2
			left join (
				select nurserId, round(sum(IFNULL(score1,0))/ count(1)) as score 
				from tab_nurser_score 
				group by nurserId
			) a3 on a3.nurserId=a2.userId
			left join	(
				select nurseId, count(1) as cnt
				from tab_user_nurse_relation
				group by nurseId
			) a4 on a4.nurseId=a1.userId
		]]>
		<where>	
	        <if test="name != null and name != ''">
				AND a2.name LIKE CONCAT('%', #{name}, '%') 
	        </if>
		</where>
		<![CDATA[
			order by IFNULL(a3.score, -1) desc
			limit #{startNum}, #{rows}
		]]>
	</select>
	
	
	<!-- 加载我的医护人员 -->
	<select id="QueryMapper.queryMyNurseInfo" 	parameterType="queryModel"	resultMap="mRetMyNurseMap">
		<![CDATA[
			select a2.*, IFNULL(a3.score, 0) as score, IFNULL(a4.cnt,0) as cnt
			from tab_user_nurse_relation a1
			inner join tab_user a2 on a1.nurseId=a2.userId
			left join (
				select nurserId, round(sum(IFNULL(score1,0))/ count(1)) as score 
				from tab_nurser_score 
				group by nurserId
			) a3 on a3.nurserId=a2.userId
			left join	(
				select nurseId, count(1) as cnt
				from tab_user_nurse_relation
				group by nurseId
			) a4 on a4.nurseId=a2.userId
			where a1.userId=#{userId}
		]]>
	</select>
	
	<!-- 医护人员明细 -->
	<select id="QueryMapper.queryNurseDetailInfo" 	parameterType="queryModel"	resultMap="mRetMyNurseMap">
		<![CDATA[
			select a2.*, IFNULL(a3.score, 0) as score, IFNULL(a4.cnt,0) as cnt
			from tab_user a2
			left join (
				select nurserId, round(sum(IFNULL(score1,0))/ count(1)) as score 
				from tab_nurser_score 
				group by nurserId
			) a3 on a3.nurserId=a2.userId
			left join	(
				select nurseId, count(1) as cnt
				from tab_user_nurse_relation
				group by nurseId
			) a4 on a4.nurseId=a2.userId
			where a2.userId=#{id}
		]]>
	</select>
	
	
	<!-- 增加签约申请-->
	<insert id="QueryMapper.addNurseRequestInfo"  parameterType="nurseRequestModel"  useGeneratedKeys="true" keyProperty="id">
	    <![CDATA[
	        INSERT INTO tab_user_bind_nurse_request (userId, nurseId, status, requestTime, memo) 
	        VALUES (#{userId}, #{nurseId}, #{status}, #{requestTime}, #{memo})
	    ]]>
	</insert>
	
	
	<!-- 查询签约申请 -->
	<select id="QueryMapper.queryNurseRequestInfo" 	parameterType="queryModel"	resultMap="mRetNurseRequestMap">
		<![CDATA[
			select a1.*, a2.name
			from tab_user_bind_nurse_request a1
			inner join tab_user a2 on a1.nurseId=a2.userId
			where a1.userId=#{userId}
			and a1.status = 0
			limit 0, 1
		]]>
	</select>
	
	
	<!-- 发送消息-->
	<insert id="QueryMapper.addSendMessageInfo"  parameterType="messageModel"  useGeneratedKeys="true" keyProperty="id">
	    <![CDATA[
	        INSERT INTO tab_msg (senderId, receiverId, sendTime, status, msg) 
	        VALUES (#{senderId}, #{receiverId}, #{sendTime}, #{status}, #{msg})
	    ]]>
	</insert>
	
	
	<!-- 查询消息 -->
	<select id="QueryMapper.queryMessageInfo" 	parameterType="queryModel"	resultMap="mRetMessageMap">
		<![CDATA[
			select a1.id, a1.senderId, a1.receiverId, a1.sendTime, a1.status, a1.readTime, a1.msg, a2.name
			from tab_msg a1
			inner join tab_user a2 on a1.senderId = a2.userId
			where a1.receiverId=#{userId}
		]]>
	</select>
	
	<!-- 增加签约申请-->
	<insert id="QueryMapper.addScoreInfo"  parameterType="scoreModel"  useGeneratedKeys="true" keyProperty="id">
	    <![CDATA[
	        INSERT INTO tab_nurser_score (userId, nurserId, score1, score2, score3, stime) 
	        VALUES (#{userId}, #{nurserId}, #{score1}, #{score2}, #{score3}, #{stime})
	    ]]>
	</insert>
	
	<!-- 查看用户当月是否有点评 -->
	<select id="QueryMapper.queryCurrentMonthMessageInfoCnt" 	parameterType="queryModel"	resultType="long">
		<![CDATA[
			select count(1)
			from tab_nurser_score a1
			where date_format(a1.stime ,'%Y-%m')=date_format(now(),'%Y-%m')
			and a1.nurserId = #{nurseId}
			and a1.userId = #{userId}
		]]>
	</select>
	
	
	<!-- 插入反馈信息 -->
	<insert id="QueryMapper.addFeedBackInfo"  parameterType="feedBackModel"  useGeneratedKeys="true" keyProperty="id">
	    <![CDATA[
	        INSERT INTO tab_feedback (feedbackType, feedbackContent, feedbackUserId, feedbackTime) 
	        VALUES (#{type}, #{content}, #{userId}, #{stime})
	    ]]>
	</insert>
	
		<!-- 查询活动的总数 -->
	<select id="QueryMapper.queryActivityInfoCnt" 	parameterType="queryModel"	resultType="long">
		<![CDATA[
			select count(1) as cnt
			from tab_activity a1
		]]>
		<where>	
			<if test="name != null and name != ''">
				AND a1.activityName LIKE CONCAT('%', #{name}, '%') 
	        </if>
        </where>
	</select>
    
	
	<!-- 分页查询活动记录 -->
	<select id="QueryMapper.queryActivityInfo" 	parameterType="queryModel"	resultMap="mRetActivityMap">
		<![CDATA[
			select a1.activityId, a1.activityType, a1.activityName, a1.activityContent, a1.activityCreatorId, 
				a1.activityCreateTime, a1.activityStartDate, a1.activityDuration, a1.activityMemo,  a1.activityIcon
			from tab_activity a1
		]]>
	     <where>	
			<if test="name != null and name != ''">
				AND a1.activityName LIKE CONCAT('%', #{name}, '%') 
	        </if>
        </where>
		<![CDATA[
			order by activityStartDate desc
			limit #{startNum}, #{rows}
		]]>
	</select>
	
	<!-- 分页查询活动记录 -->
	<select id="QueryMapper.queryActivityInfoById" 	parameterType="queryModel"	resultMap="mRetActivityMap">
		<![CDATA[
			select a1.activityId, a1.activityType, a1.activityName, a1.activityContent, a1.activityCreatorId, 
				a1.activityCreateTime, a1.activityStartDate, a1.activityDuration, a1.activityMemo,  a1.activityIcon
			from tab_activity a1
			where a1.activityId = #{id}
		]]>
	</select>
	
	
	<!-- 加载活动医生 -->
	<select id="QueryMapper.queryActivityDoctorInfo" 	parameterType="queryModel"	resultMap="mDoctorMap">
		<![CDATA[
			select CONCAT(a2.doctorName, '(', a3.hospitalName,')') as doctorName, a1.doctorId
			from tab_activity_doctor a1
			inner join tab_doctor a2 on a1.doctorId=a2.doctorId
			left join tab_hospital a3 on a3.hospitalId=a2.doctorHospitalId
			where a1.activityId = #{id}
		]]>
	</select>
	
	<!-- 查询论坛的总数 -->
	<select id="QueryMapper.queryPostInfoCnt" 	parameterType="queryModel"	resultType="long">
		<![CDATA[
			select count(1) as cnt
			from tab_post a1
		]]>
		<where>	
			<if test="title != null and title != ''">
				AND a1.postTitle LIKE CONCAT('%', #{title}, '%') 
	        </if>
        </where>
	</select>
	
	
	<!-- 分页查询论坛记录 -->
	<select id="QueryMapper.queryPostInfo" 	parameterType="queryModel"	resultMap="mRetPostMap">
		<![CDATA[
			select a1.postId, a1.postTitle, a1.postContent, a1.postTime, a1.postUserId, a1.postUserName, a2.photo
			from tab_post a1
			left join tab_user a2 on a2.userId=a1.postUserId
		]]>
	     <where>	
			<if test="title != null and title != ''">
				AND a1.postTitle LIKE CONCAT('%', #{title}, '%') 
	        </if>
        </where>
		<![CDATA[
			order by postTime desc
			limit #{startNum}, #{rows}
		]]>
	</select>
	
	<!-- 查看论坛详细 -->
	<select id="QueryMapper.queryPostInfoById" 	parameterType="queryModel"	resultMap="mRetPostMap">
		<![CDATA[
			select a1.postId, a1.postTitle, a1.postContent, a1.postTime, a1.postUserId, a1.postUserName, a2.photo
			from tab_post a1
			left join tab_user a2 on a2.userId=a1.postUserId
			where a1.postId = #{id}
		]]>
	</select>
	
	<!-- 插入论坛信息 -->
	<insert id="QueryMapper.addPostInfo"  parameterType="feedBackModel"  useGeneratedKeys="true" keyProperty="id">
	    <![CDATA[
	        INSERT INTO tab_post (postTitle, postContent, postTime, postUserId, postUserName) 
	        VALUES (#{title}, #{content}, #{stime}, #{userId}, #{userName})
	    ]]>
	</insert>
	
	<!-- 查询评论列表总数 -->
	<select id="QueryMapper.queryPostCommentInfoCnt" 	parameterType="queryModel"	resultType="long">
		<![CDATA[
			select count(1) as cnt
			from tab_comment a1
			where a1.commentPostId = #{id}
		]]>
	</select>
	
	<!-- 查询评论列表 -->
	<select id="QueryMapper.queryPostCommentInfo" 	parameterType="queryModel"	resultMap="mRetPostCommentMap">
		<![CDATA[
			select a1.commentContent, a1.commentTime, a1.commentUserName, a2.photo
			from tab_comment a1
			left join tab_user a2 on a2.userId=a1.commentUserId
			where a1.commentPostId = #{id}
			order by commentTime
			limit #{startNum}, #{rows}
		]]>
	</select>
	
	
	<!-- 插入评论信息 -->
	<insert id="QueryMapper.addPostCommentInfo"  parameterType="commentModel"  useGeneratedKeys="true" keyProperty="id">
	    <![CDATA[
	        INSERT INTO tab_comment (commentPostId, commentContent, commentTime, commentUserId, commentUserName) 
	        VALUES (#{pid}, #{content}, #{stime}, #{userId}, #{userName})
	    ]]>
	</insert>
	
	<!-- 血糖统计 -->
	<select id="QueryMapper.queryStatBloodInfo" 	parameterType="queryModel"	resultMap="mRetStatBooldMap">
		<![CDATA[
			select a.bloodGlucose1 as value, a.bloodGlucose2 as flag, STR_TO_DATE(a.takeTime,'%Y-%m-%d')  as takeTime 
			from tab_blood_glucose a
			where a.userId = #{userId}
		]]>
		<if test="startTime != null and startTime != ''">
		    AND a.takeTime >=   STR_TO_DATE(#{startTime},'%Y-%m-%d %H:%i:%s')
		</if>
		<if test="endTime != null and  endTime != ''">
			<![CDATA[ 
				AND a.takeTime <=   STR_TO_DATE(#{endTime},'%Y-%m-%d %H:%i:%s')
			]]>
		</if>
	</select>
	
	<!-- 耳朵统计 -->
	<select id="QueryMapper.queryStatEarInfo" 	parameterType="queryModel"	resultMap="mRetStatBooldMap">
		<![CDATA[
			select a.temperature as value, 0 as flag, a.takeTime 
			from tab_ear_thermometer a
			where a.userId = #{userId}
		]]>
		<if test="startTime != null and startTime != ''">
		    AND a.takeTime >=   STR_TO_DATE(#{startTime},'%Y-%m-%d %H:%i:%s')
		</if>
		<if test="endTime != null and  endTime != ''">
			<![CDATA[ 
				AND a.takeTime <=   STR_TO_DATE(#{endTime},'%Y-%m-%d %H:%i:%s')
			]]>
		</if>
	</select>
	
	
	<!-- 血压统计 -->
	<select id="QueryMapper.queryStatBloodPressureInfo" 	parameterType="queryModel"	resultMap="mRetStatBooldPressureMap">
		<![CDATA[
			select a.highBloodPressure, a.lowBloodPressure, a.pulse, a.takeTime 
			from tab_blood_pressure a
			where a.userId = #{userId}
		]]>
		<if test="startTime != null and startTime != ''">
		    AND a.takeTime >=   STR_TO_DATE(#{startTime},'%Y-%m-%d %H:%i:%s')
		</if>
		<if test="endTime != null and  endTime != ''">
			<![CDATA[ 
				AND a.takeTime <=   STR_TO_DATE(#{endTime},'%Y-%m-%d %H:%i:%s')
			]]>
		</if>
	</select>
	
	<!-- 加载最近的血糖 -->
	<select id="QueryMapper.queryRecentlyHomeBloodInfo" 	parameterType="queryModel"	resultMap="mRetRecentlyHomeBloodMap">
		<![CDATA[
			select FORMAT(a.bloodGlucose1/10, 1) as bloodGlucose1, a.takeTime1, FORMAT(a.bloodGlucose2/10, 1) as bloodGlucose2, a.takeTime2
			from tab_blood_glucose a
			where a.userId = #{userId}
			order by a.takeTime DESC
			LIMIT 0, 1
		]]>
	</select>
	
	
	
	<!-- 加载最近的血压 -->
	<select id="QueryMapper.queryRecentlyHomePressureInfo" 	parameterType="queryModel"	resultMap="mRetRecentlyHomePressureMap">
		<![CDATA[
			select CONCAT(a.highBloodPressure , '/', a.lowBloodPressure) as BloodPressure, a.takeTime
			from tab_blood_pressure a
			where a.userId = #{userId}
			order by a.takeTime DESC
			LIMIT 0, 1
		]]>
	</select>
	
	<!-- 加载最近的体温 -->
	<select id="QueryMapper.queryRecentlyHomeEarInfo" 	parameterType="queryModel"	resultMap="mRetRecentlyHomeEarMap">
		<![CDATA[
			select FORMAT(a.temperature/10, 1) as temperature, a.takeTime
			from tab_ear_thermometer a
			where a.userId = #{userId}
			order by a.takeTime DESC
			LIMIT 0, 1
		]]>
	</select>
	
	<!-- 加载最近 -->
	<select id="QueryMapper.queryHomeDoctorAdviceInfo" 	parameterType="queryModel"	resultMap="mRetHomeDoctorAdviceMap">
		<![CDATA[
			select a.adviceTime as a, a.adviceContent as b, b.doctorAdvicePerformace as c, b.recordTime as d
			from tab_doctor_advice a
			left join tab_doctor_advice_performace b on a.id=b.doctorAdviceId
			where a.userId = #{userId}
			and a.adviceTypId = #{adviceType}
			and a.adviceTime >= SUBDATE(now(),interval 30 day)
			order by a.adviceTime DESC
			LIMIT 0, 1
		]]>
	</select>
	
	<!-- 加载最近 -->
	<select id="QueryMapper.queryHomeDoctorAdvice15Info" 	parameterType="queryModel"	resultMap="mRetHomeDoctorAdviceMap">
		<![CDATA[
			select a.adviceTime as a, a.adviceContent as b, b.doctorAdvicePerformace as c, b.recordTime as d
			from tab_doctor_advice a
			left join tab_doctor_advice_performace b on a.id=b.doctorAdviceId
			where a.userId = #{userId}
			and a.adviceTypId = #{adviceType}
			and a.adviceTime >= SUBDATE(now(),interval 15 day)
			order by a.adviceTime DESC
			LIMIT 0, 4
		]]>
	</select>
	
	<!-- 加载用户信息 -->
	<select id="QueryMapper.queryHealthUserInfo" 	parameterType="queryModel"	resultMap="mRetHealthUserMap">
		<![CDATA[
			SELECT a.userId, a.name, a.gender, TIMESTAMPDIFF(YEAR,a.birthdate, NOW())  as birthdate, a.height, a.weight, FORMAT(a.weight / (a.height/100 * a.height/100), 2) as bmi
			FROM tab_user a
			where a.userId = #{userId}
		]]>
	</select>
	
	
	<!-- 加载运动记录 -->
	<select id="QueryMapper.queryHealthSportInfo" 	parameterType="queryModel"	resultMap="mRetHealthSportMap">
		<![CDATA[
			SELECT b.sportName, a.sportTime, a.sportDuration, b.caloriePerMinute * a.sportDuration as caloriePerMinute
			FROM tab_sport_record a
			LEFT JOIN tab_dict_sport_item b on a.sportItemId=b.id
			where a.userId = #{userId}
			and date_format(a.sportTime, '%Y-%m-%d') = #{startTime}
			order by a.sportTime
		]]>
	</select>
	
	
	<!-- 加载运动记录 按月 -->
	<select id="QueryMapper.queryHealthSportMonthInfo" 	parameterType="queryModel"	resultMap="mRetHealthSportMap">
		<![CDATA[
			SELECT b.sportName, '' as sportTime, SUM(a.sportDuration) as sportDuration, SUM(b.caloriePerMinute * a.sportDuration) as caloriePerMinute
			FROM tab_sport_record a
			LEFT JOIN tab_dict_sport_item b on a.sportItemId=b.id
			where a.userId = #{userId}
		]]>
		<if test="statType != null and statType == 2">
		    <![CDATA[
			and date_format(a.sportTime, '%Y-%m-%d') >= #{startTime}
			and date_format(a.sportTime, '%Y-%m-%d') <= #{endTime}
			]]>
        </if>
        <if test="statType != null and statType == 3">
			and date_format(a.sportTime, '%Y-%m') = #{startTime}
        </if>
        <![CDATA[
			group by b.sportName
			order by b.sportName
		]]>
	</select>
	
	
	<!-- 加载运动记录 分析 按月 -->
	<select id="QueryMapper.queryHealthSportMonthFxInfo" 	parameterType="queryModel"	resultMap="mRetHealthSportMonthFxMap">
		<![CDATA[
			SELECT SUM(a.sportDuration) as a, SUM(b.caloriePerMinute * a.sportDuration) as b,
				FORMAT(SUM(a.sportDuration)/COUNT(DISTINCT date_format(a.sportTime, '%Y-%m')), 2) as c,
				FORMAT(SUM(b.caloriePerMinute * a.sportDuration)/COUNT(DISTINCT date_format(a.sportTime, '%Y-%m')), 2) as d
			FROM tab_sport_record a 
			LEFT JOIN tab_dict_sport_item b on a.sportItemId=b.id
			where a.userId = #{userId}
		]]>
		<if test="statType != null and statType == 2">
		    <![CDATA[
			and date_format(a.sportTime, '%Y-%m-%d') >= #{startTime}
			and date_format(a.sportTime, '%Y-%m-%d') <= #{endTime}
			]]>
        </if>
        <if test="statType != null and statType == 3">
			and date_format(a.sportTime, '%Y-%m') = #{startTime}
        </if>
	</select>
	
	
	
	
	<!-- 加载饮食记录 -->
	<select id="QueryMapper.queryHealthFoodInfo" 	parameterType="queryModel"	resultMap="mRetHealthFootMap">
		<![CDATA[
			SELECT a.mealFlag, MAX(a.mealTime) as mealTime, FORMAT(SUM(a.amount * b.caloriePerHundredGram / 100), 2) as amount
			FROM tab_food_record a
			LEFT JOIN tab_dict_food b on a.foodItem=b.id
			LEFT JOIN tab_dict_food_type c on c.id=b.foodType
			where a.userId = #{userId}
			and date_format(a.mealTime, '%Y-%m-%d') = #{startTime}
			group by a.mealFlag
			order by a.mealFlag
		]]>
	</select>
	
	
	<!-- 加载饮食记录 按月-->
	<select id="QueryMapper.queryHealthFoodMonthInfo" 	parameterType="queryModel"	resultMap="mRetHealthFootMonthMap">
		<![CDATA[
			SELECT c.name, SUM(a.amount) as amount,  
			FORMAT(SUM(a.amount * b.caloriePerHundredGram / 100), 2) as caloriePerHundredGram, 
			FORMAT(SUM(a.amount)/COUNT(DISTINCT date_format(a.mealTime, '%Y-%m')), 2) as avgAmount,
			FORMAT(SUM(a.amount * b.caloriePerHundredGram / 100)/COUNT(DISTINCT date_format(a.mealTime, '%Y-%m')), 2) as avgCaloriePerHundredGram
			FROM tab_food_record a
			LEFT JOIN tab_dict_food b on a.foodItem=b.id
			LEFT JOIN tab_dict_food_type c on c.id=b.foodType
			where a.userId = #{userId}
		]]>
		<if test="statType != null and statType == 2">
		    <![CDATA[
			and date_format(a.mealTime, '%Y-%m-%d') >= #{startTime}
			and date_format(a.mealTime, '%Y-%m-%d') <= #{endTime}
			]]>
        </if>
        <if test="statType != null and statType == 3">
			and date_format(a.mealTime, '%Y-%m') = #{startTime}
        </if>
        <![CDATA[
			group by c.name
			order by c.name
		]]>
	</select>
	
	
	<!-- 加载饮食记录 -->
	<select id="QueryMapper.queryHealthFoodSumInfo" 	parameterType="queryModel"	resultMap="mRetHealthFootMap">
		<![CDATA[
			SELECT '' as mealFlag, date_format(MAX(a.mealTime), '%Y-%m-%d') as mealTime, FORMAT(SUM(a.amount * b.caloriePerHundredGram / 100), 2) as amount
			FROM tab_food_record a
			LEFT JOIN tab_dict_food b on a.foodItem=b.id
			LEFT JOIN tab_dict_food_type c on c.id=b.foodType
			where a.userId = #{userId}
			and date_format(a.mealTime, '%Y-%m-%d') = #{startTime}
		]]>
	</select>
	
	
	<!-- 加载饮食类细项 -->
	<select id="QueryMapper.queryHealthFoodItemSumInfo" 	parameterType="queryModel"	resultMap="mRetHealthFootItemMap">
		<![CDATA[
			SELECT  c.id, c.name, SUM(a.amount) as amount
			FROM tab_food_record a
			LEFT JOIN tab_dict_food b on a.foodItem=b.id
			LEFT JOIN tab_dict_food_type c on c.id=b.foodType
			where a.userId = #{userId}
			and date_format(a.mealTime, '%Y-%m-%d') = #{startTime}
			group by c.id
			order by c.id
		]]>
	</select>
	
	
	
	<!-- 加载饮食类细项 -->
	<select id="QueryMapper.queryHealthFoodItemInfo" 	parameterType="queryModel"	resultMap="mRetHealthFootItemMap">
		<![CDATA[
			SELECT  c.id, c.name, SUM(a.amount) as amount
			FROM tab_food_record a
			LEFT JOIN tab_dict_food b on a.foodItem=b.id
			LEFT JOIN tab_dict_food_type c on c.id=b.foodType
			where a.mealFlag = #{type}
			and a.userId = #{userId}
			and date_format(a.mealTime, '%Y-%m-%d') = #{startTime}
			group by c.id
			order by c.id
		]]>
	</select>
	


	
	<!-- 加载心理状态 -->
	<select id="QueryMapper.queryHealthMentalInfo" 	parameterType="queryModel"	resultMap="mRetHealthMentalMap">
		<![CDATA[
			SELECT a.mentalStatus, a.recordTime
			FROM tab_mental_record a
			where a.userId = #{userId}
			and date_format(a.recordTime, '%Y-%m-%d') = #{startTime}
			order by a.recordTime
		]]>
	</select>
	
	
	
	<!-- 加载心理状态 按月-->
	<select id="QueryMapper.queryHealthMentalMonthInfo" 	parameterType="queryModel"	resultMap="mRetHealthMentalMonthMap">
		<![CDATA[
			SELECT a.mentalStatus, COUNT(1) as cnt
			from tab_mental_record a
			where a.userId = #{userId}
		]]>
		<if test="statType != null and statType == 2">
		    <![CDATA[
			and date_format(a.recordTime, '%Y-%m-%d') >= #{startTime}
			and date_format(a.recordTime, '%Y-%m-%d') <= #{endTime}
			]]>
        </if>
        <if test="statType != null and statType == 3">
			and date_format(a.recordTime, '%Y-%m') = #{startTime}
        </if>
        <![CDATA[
			group by a.mentalStatus
			order by a.mentalStatus
		]]>
	</select>
	
	
	
	<!-- 加载血压 -->
	<select id="QueryMapper.queryHealthPressureInfo" 	parameterType="queryModel"	resultMap="mRetHealthPressureMap">
		<![CDATA[
			SELECT a.highBloodPressure, a.lowBloodPressure, a.pulse, a.takeTime
			FROM tab_blood_pressure a
			where a.userId = #{userId}
			and date_format(a.takeTime, '%Y-%m-%d') = #{startTime}
			order by a.takeTime
		]]>
	</select>
	
	
	
	<!-- 加载血压  按月-->
	<select id="QueryMapper.queryHealthPressureMonthInfo" 	parameterType="queryModel"	resultMap="mRetHealthPressureMonthMap">
		<![CDATA[
			SELECT COUNT(1) as a1, 
			  	SUM(CASE WHEN a.highBloodPressure >=90 and a.highBloodPressure <= 130 
				and a.lowBloodPressure >=60 and a.lowBloodPressure<=80 THEN 1 ELSE 0 END) as a2,
				SUM(CASE WHEN a.highBloodPressure >130 THEN 1 ELSE 0 END) as a3,
				SUM(CASE WHEN a.highBloodPressure <90 THEN 1 ELSE 0 END) as a4,
				SUM(CASE WHEN a.lowBloodPressure >80 THEN 1 ELSE 0 END) as a5,
				SUM(CASE WHEN a.lowBloodPressure <60 THEN 1 ELSE 0 END) as a6
			FROM tab_blood_pressure a
			where a.userId = #{userId}
		]]>
		<if test="statType != null and statType == 2">
		    <![CDATA[
			and date_format(a.takeTime, '%Y-%m-%d') >= #{startTime}
			and date_format(a.takeTime, '%Y-%m-%d') <= #{endTime}
			]]>
        </if>
        <if test="statType != null and statType == 3">
			and date_format(a.takeTime, '%Y-%m') = #{startTime}
        </if>
	</select>
	
	


	<!-- 加载心率 -->
	<select id="QueryMapper.queryHealthPulseInfo" 	parameterType="queryModel"	resultMap="mRetHealthPulseMap">
		<![CDATA[
			SELECT a.heartRate, a.takeTime
			FROM tab_blood_pressure a
			where a.userId = #{userId}
			and date_format(a.takeTime, '%Y-%m-%d') = #{startTime}
			and a.pulse > 0			
			order by a.takeTime
		]]>
	</select>
	
	
	<!-- 加载心率 按月-->
	<select id="QueryMapper.queryHealthPulseMonthInfo" 	parameterType="queryModel"	resultMap="mRetHealthPulseMonthMap">
		<![CDATA[
			SELECT COUNT(1) as a1,
				SUM(CASE WHEN a.heartRate>=60 AND a.heartRate<=100 THEN 1 ELSE 0 END) a2,
				SUM(CASE WHEN a.heartRate >100 THEN 1 ELSE 0 END) a3,
				SUM(CASE WHEN a.heartRate<60 THEN 1 ELSE 0 END) a4
			FROM tab_blood_pressure a
			where a.userId = #{userId}
		]]>
		<if test="statType != null and statType == 2">
		    <![CDATA[
			and date_format(a.takeTime, '%Y-%m-%d') >= #{startTime}
			and date_format(a.takeTime, '%Y-%m-%d') <= #{endTime}
			]]>
        </if>
        <if test="statType != null and statType == 3">
			and date_format(a.takeTime, '%Y-%m') = #{startTime}
        </if>
        <![CDATA[
			and a.pulse > 0			
			order by a.takeTime
		]]>
	</select>
	
	
	
	<!-- 加载血糖 -->
	<select id="QueryMapper.queryHealthGlucoseInfo" 	parameterType="queryModel"	resultMap="mRetHealthGlucoseMap">
		<![CDATA[
			SELECT a.takeTime1, FORMAT(a.bloodGlucose1/10, 1) as bloodGlucose1, a.takeTime2, FORMAT(a.bloodGlucose2/10, 1) as bloodGlucose2
			FROM tab_blood_glucose a
			where a.userId = #{userId}
			and date_format(a.takeTime, '%Y-%m-%d') = #{startTime}
			order by a.takeTime
		]]>
	</select>
	
	
	
	<!-- 加载血糖 按月-->
	<select id="QueryMapper.queryHealthGlucoseMonthInfo" 	parameterType="queryModel"	resultMap="mRetHealthGlucoseMonthMap">
		<![CDATA[
			SELECT 
				SUM(CASE WHEN a.bloodGlucose1>=36 AND a.bloodGlucose1<=61 THEN 1 ELSE 0 END) + 
				SUM(CASE WHEN a.bloodGlucose2>=36 AND a.bloodGlucose2<=77 THEN 1 ELSE 0 END) a1,
				SUM(CASE WHEN a.bloodGlucose1 >61 THEN 1 ELSE 0 END) + 
				SUM(CASE WHEN a.bloodGlucose2 >77 THEN 1 ELSE 0 END) a2,
				SUM(CASE WHEN a.bloodGlucose1 >0 AND a.bloodGlucose1<36 THEN 1 ELSE 0 END) + 
				SUM(CASE WHEN a.bloodGlucose2 >0 AND a.bloodGlucose2<36 THEN 1 ELSE 0 END) a3
			FROM tab_blood_glucose a
			where a.userId = #{userId}
		]]>
		<if test="statType != null and statType == 2">
		    <![CDATA[
			and date_format(a.takeTime, '%Y-%m-%d') >= #{startTime}
			and date_format(a.takeTime, '%Y-%m-%d') <= #{endTime}
			]]>
        </if>
        <if test="statType != null and statType == 3">
			and date_format(a.takeTime, '%Y-%m') = #{startTime}
        </if>
	</select>
	
	
	
	<!-- 加载体温 -->
	<select id="QueryMapper.queryHealthThermometerInfo" 	parameterType="queryModel"	resultMap="mRetHealthThermometerMap">
		<![CDATA[
			SELECT a.takeTime, FORMAT(a.temperature/10, 1) as temperature
			FROM tab_ear_thermometer a
			where a.userId = #{userId}
			and date_format(a.takeTime, '%Y-%m-%d') = #{startTime}
			order by a.takeTime
		]]>
	</select>
	
	
	<!-- 加载体温 按月-->
	<select id="QueryMapper.queryHealthThermometerMonthInfo" 	parameterType="queryModel"	resultMap="mRetHealthGlucoseMonthMap">
		<![CDATA[
			SELECT COUNT(1) as a1,
				SUM(CASE WHEN a.temperature>=360 AND a.temperature <=372 THEN 1 ELSE 0 END) as a2,
				SUM(CASE WHEN a.temperature < 360 OR a.temperature > 372 THEN 1 ELSE 0 END) AS a3
			FROM tab_ear_thermometer a
			where a.userId = #{userId}
		]]>
		<if test="statType != null and statType == 2">
		    <![CDATA[
			and date_format(a.takeTime, '%Y-%m-%d') >= #{startTime}
			and date_format(a.takeTime, '%Y-%m-%d') <= #{endTime}
			]]>
        </if>
        <if test="statType != null and statType == 3">
			and date_format(a.takeTime, '%Y-%m') = #{startTime}
        </if>
	</select>
	
	

	<!-- 删除健康报告-->
	<delete id="QueryMapper.delHealthRepeatInfo">
		<![CDATA[
			DELETE FROM tab_health_report_evaluation 
			WHERE userId = #{userId} 
			and reportFlag = #{reportFlag}
			and reportTime = #{reportTime}
		]]>
	</delete>
	
	<!-- 插入健康报告 -->
	<insert id="QueryMapper.addHealthRepeatInfo"  parameterType="healthReportModel"  useGeneratedKeys="true" keyProperty="id">
	    <![CDATA[
	        INSERT INTO tab_health_report_evaluation (reportFlag, sportLevel, sportAdvice, dietLevel, dietAdvice, mentalAdvice, bloodPressureAdvice, bloodGlucoseAdvice, heartRateAdvice, temperatureAdvice, medicationAdvice, reportTime, Accessment, recordTime, userId) 
	        VALUES (#{reportFlag}, #{sportLevel}, #{sportAdvice}, #{dietLevel}, #{dietAdvice}, #{mentalAdvice}, #{bloodPressureAdvice}, #{bloodGlucoseAdvice}, #{heartRateAdvice}, #{temperatureAdvice}, #{medicationAdvice}, #{reportTime}, #{accessment}, #{recordTime}, #{userId})
	    ]]>
	</insert>
	
	
	<!-- 加载健康报告信息 -->
	<select id="QueryMapper.queryHealthReportInfo" 	parameterType="healthReportModel"	resultMap="mRetHealthReportMap">
		<![CDATA[
			SELECT *
			FROM tab_health_report_evaluation a
			where a.userId = #{userId}
			and a.reportTime = #{reportTime}
			and a.reportFlag = #{reportFlag}
			LIMIT 0, 1
		]]>
	</select>
	
	
	
	<!-- 用药记录 -->
	<select id="QueryMapper.queryHealthMedicineInfo" 	parameterType="queryModel"	resultMap="mRetHealthMedicineMap">
		<![CDATA[
			SELECT a.medicineName, a.medicineAmount, a.medicineUnit, a.medicineTime
			FROM tab_medicine_record a
			where a.userId = #{userId}
			and date_format(a.medicineTime, '%Y-%m-%d') = #{startTime}
			ORDER BY a.medicineTime
		]]>
	</select>
	
	
	
	<!-- 用药记录 按月-->
	<select id="QueryMapper.queryHealthMedicineMonthInfo" 	parameterType="queryModel"	resultMap="mRetHealthMedicineMonthMap">
		<![CDATA[
			SELECT a.medicineName as a, COUNT(1) as b, FORMAT(AVG(a.medicineAmount),1) as c, SUM(a.medicineAmount) as d, MAX(a.medicineUnit) as e
			FROM tab_medicine_record a
			where a.userId = #{userId}
		]]>
		<if test="statType != null and statType == 2">
		    <![CDATA[
			and date_format(a.medicineTime, '%Y-%m-%d') >= #{startTime}
			and date_format(a.medicineTime, '%Y-%m-%d') <= #{endTime}
			]]>
        </if>
        <if test="statType != null and statType == 3">
			and date_format(a.medicineTime, '%Y-%m') = #{startTime}
        </if>
        <![CDATA[
			GROUP BY a.medicineName
			ORDER BY a.medicineName
		]]>
	</select>
	
	
	<!-- 用药记录总数 -->
	<select id="QueryMapper.queryMedicineInfoCnt" parameterType="queryModel" resultType="long">
		<![CDATA[
			SELECT count(1) as cnt
			FROM tab_medicine_record a
			where a.userId = #{userId}
		]]>
		<if test="name != null and name != ''">
			AND a.medicineName LIKE CONCAT('%', #{name}, '%') 
        </if>
		<if test="startTime != null and startTime != ''">
			and a.medicineTime >= #{startTime}
        </if>
		<if test="endTime != null and endTime != ''">
		    <![CDATA[
			and a.medicineTime <= #{endTime}
			]]>
        </if>
        <![CDATA[
			ORDER BY a.medicineTime
		]]>
	</select>
	
	
	<!-- 用药记录 分页 -->
	<select id="QueryMapper.queryMedicineInfo" parameterType="queryModel" resultMap="mRetMedicineMap">
		<![CDATA[
			SELECT a.*
			FROM tab_medicine_record a
			where a.userId = #{userId}
		]]>
		<if test="name != null and name != ''">
			AND a.medicineName LIKE CONCAT('%', #{name}, '%') 
        </if>
		<if test="startTime != null and startTime != ''">
			and a.medicineTime >= #{startTime}
        </if>
		<if test="endTime != null and endTime != ''">
		    <![CDATA[
			and a.medicineTime <= #{endTime}
			]]>
        </if>
        <![CDATA[
			ORDER BY a.medicineTime
			LIMIT #{startNum}, #{rows}
		]]>
	</select>
	
	
	<!-- 用药记录 分页 -->
	<select id="QueryMapper.queryMedicineInfoById" parameterType="queryModel" resultMap="mRetMedicineMap">
		<![CDATA[
			SELECT a.*
			FROM tab_medicine_record a
			WHERE id = #{id} 
		]]>
	</select>
	
	
	<!-- 插入用药记录-->
	<insert id="QueryMapper.addMedicineInfo" useGeneratedKeys="true" keyProperty="id">
	    <![CDATA[
	        INSERT INTO tab_medicine_record (userId, medicineName, medicineAmount, medicineUnit, medicineTime) 
	        VALUES (#{userId}, #{medicineName}, #{medicineAmount}, #{medicineUnit}, #{medicineTime})
	    ]]>
	</insert>
	
	
	<!-- 删除用药记录-->
	<delete id="QueryMapper.delMedicineInfo">
		<![CDATA[
			DELETE FROM tab_medicine_record 
			WHERE id = #{id} 
		]]>
	</delete>
	
	<!-- 修改用药记录-->
	<update id="QueryMapper.modifyMedicineInfo" parameterType="medicineModel">
		<![CDATA[
			UPDATE tab_medicine_record  SET  
			userId = #{userId},
			medicineName = #{medicineName}, 
			medicineAmount = #{medicineAmount}, 
			medicineUnit = #{medicineUnit}, 
			medicineTime = #{medicineTime}
			WHERE id = #{id} 
		]]>
	</update>
</mapper>
